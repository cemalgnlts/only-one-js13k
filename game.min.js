(()=>{var q=()=>{},Jt="position:absolute;width:1px;height:1px;overflow:hidden;clip:rect(0,0,0,0);";function vt(e,t){let i=t.parentNode;if(e.setAttribute("data-kontra",""),i){let s=i.querySelector("[data-kontra]:last-of-type")||t;i.insertBefore(e,s.nextSibling)}else document.body.appendChild(e)}function kt(e,t){let i=e.indexOf(t);if(i!=-1)return e.splice(i,1),!0}var H={};function et(e,t){H[e]=H[e]||[],H[e].push(t)}function Zt(e,t){H[e]=(H[e]||[]).filter(i=>i!=t)}function j(e,...t){(H[e]||[]).map(i=>i(...t))}var X,Z,Ct={get(e,t){return t=="_proxy"?!0:q}};function Mt(){return X}function $(){return Z}function Tt(e,{contextless:t=!1}={}){if(X=document.getElementById(e)||e||document.querySelector("canvas"),t&&(X=X||new Proxy({},Ct)),!X)throw Error("You must provide a canvas element for the game");return Z=X.getContext("2d")||new Proxy({},Ct),Z.imageSmoothingEnabled=!1,j("init"),{canvas:X,context:Z}}function jt(e,t){let i=Math.sin(t),s=Math.cos(t);return{x:e.x*s-e.y*i,y:e.x*i+e.y*s}}function R(e,t,i){return Math.min(Math.max(e,i),t)}function te(e,t){return[e,t]=[e,t].map(i=>W(i)),e.x<t.x+t.width&&e.x+e.width>t.x&&e.y<t.y+t.height&&e.y+e.height>t.y}function W(e){let{x:t=0,y:i=0,width:s,height:n}=e.world||e;return e.mapwidth&&(s=e.mapwidth,n=e.mapheight),e.anchor&&(t-=s*e.anchor.x,i-=n*e.anchor.y),s<0&&(t+=s,s*=-1),n<0&&(i+=n,n*=-1),{x:t,y:i,width:s,height:n}}var lt=class e{constructor(t=0,i=0,s={}){t.x!=null?(this.x=t.x,this.y=t.y):(this.x=t,this.y=i),s._c&&(this.clamp(s._a,s._b,s._d,s._e),this.x=t,this.y=i)}set(t){this.x=t.x,this.y=t.y}add(t){return new e(this.x+t.x,this.y+t.y,this)}subtract(t){return new e(this.x-t.x,this.y-t.y,this)}scale(t){return new e(this.x*t,this.y*t)}normalize(t=this.length()||1){return new e(this.x/t,this.y/t)}dot(t){return this.x*t.x+this.y*t.y}length(){return Math.hypot(this.x,this.y)}distance(t){return Math.hypot(this.x-t.x,this.y-t.y)}angle(t){return Math.acos(this.dot(t)/(this.length()*t.length()))}direction(){return Math.atan2(this.y,this.x)}clamp(t,i,s,n){this._c=!0,this._a=t,this._b=i,this._d=s,this._e=n}get x(){return this._x}get y(){return this._y}set x(t){this._x=this._c?R(this._a,this._d,t):t}set y(t){this._y=this._c?R(this._b,this._e,t):t}};function P(){return new lt(...arguments)}var dt=class{constructor(t){return this.init(t)}init(t={}){this.position=P(),this.velocity=P(),this.acceleration=P(),this.ttl=1/0,Object.assign(this,t)}update(t){this.advance(t)}advance(t){let i=this.acceleration;t&&(i=i.scale(t)),this.velocity=this.velocity.add(i);let s=this.velocity;t&&(s=s.scale(t)),this.position=this.position.add(s),this._pc(),this.ttl--}get dx(){return this.velocity.x}get dy(){return this.velocity.y}set dx(t){this.velocity.x=t}set dy(t){this.velocity.y=t}get ddx(){return this.acceleration.x}get ddy(){return this.acceleration.y}set ddx(t){this.acceleration.x=t}set ddy(t){this.acceleration.y=t}isAlive(){return this.ttl>0}_pc(){}},tt=class extends dt{init({width:t=0,height:i=0,context:s=$(),render:n=this.draw,update:h=this.advance,children:a=[],anchor:d={x:0,y:0},opacity:f=1,rotation:c=0,scaleX:o=1,scaleY:g=1,...l}={}){this._c=[],super.init({width:t,height:i,context:s,anchor:d,opacity:f,rotation:c,scaleX:o,scaleY:g,...l}),this._di=!0,this._uw(),this.addChild(a),this._rf=n,this._uf=h,et("init",()=>{this.context??=$()})}update(t){this._uf(t),this.children.map(i=>i.update&&i.update(t))}render(){let t=this.context;t.save(),(this.x||this.y)&&t.translate(this.x,this.y),this.rotation&&t.rotate(this.rotation),(this.scaleX!=1||this.scaleY!=1)&&t.scale(this.scaleX,this.scaleY);let i=-this.width*this.anchor.x,s=-this.height*this.anchor.y;(i||s)&&t.translate(i,s),this.context.globalAlpha=this.opacity,this._rf(),(i||s)&&t.translate(-i,-s),this.children.map(h=>h.render&&h.render()),t.restore()}draw(){}_pc(){this._uw(),this.children.map(t=>t._pc())}get x(){return this.position.x}get y(){return this.position.y}set x(t){this.position.x=t,this._pc()}set y(t){this.position.y=t,this._pc()}get width(){return this._w}set width(t){this._w=t,this._pc()}get height(){return this._h}set height(t){this._h=t,this._pc()}_uw(){if(!this._di)return;let{_wx:t=0,_wy:i=0,_wo:s=1,_wr:n=0,_wsx:h=1,_wsy:a=1}=this.parent||{};this._wx=this.x,this._wy=this.y,this._ww=this.width,this._wh=this.height,this._wo=s*this.opacity,this._wsx=h*this.scaleX,this._wsy=a*this.scaleY,this._wx=this._wx*h,this._wy=this._wy*a,this._ww=this.width*this._wsx,this._wh=this.height*this._wsy,this._wr=n+this.rotation;let{x:d,y:f}=jt({x:this._wx,y:this._wy},n);this._wx=d,this._wy=f,this._wx+=t,this._wy+=i}get world(){return{x:this._wx,y:this._wy,width:this._ww,height:this._wh,opacity:this._wo,rotation:this._wr,scaleX:this._wsx,scaleY:this._wsy}}set children(t){this.removeChild(this._c),this.addChild(t)}get children(){return this._c}addChild(...t){t.flat().map(i=>{this.children.push(i),i.parent=this,i._pc=i._pc||q,i._pc()})}removeChild(...t){t.flat().map(i=>{kt(this.children,i)&&(i.parent=null,i._pc())})}get opacity(){return this._opa}set opacity(t){this._opa=R(0,1,t),this._pc()}get rotation(){return this._rot}set rotation(t){this._rot=t,this._pc()}setScale(t,i=t){this.scaleX=t,this.scaleY=i}get scaleX(){return this._scx}set scaleX(t){this._scx=t,this._pc()}get scaleY(){return this._scy}set scaleY(t){this._scy=t,this._pc()}};var ct=class extends tt{init({image:t,width:i=t?t.width:void 0,height:s=t?t.height:void 0,...n}={}){super.init({image:t,width:i,height:s,...n})}get animations(){return this._a}set animations(t){let i,s;this._a={};for(i in t)this._a[i]=t[i].clone(),s=s||this._a[i];this.currentAnimation=s,this.width=this.width||s.width,this.height=this.height||s.height}playAnimation(t){this.currentAnimation?.stop(),this.currentAnimation=this.animations[t],this.currentAnimation.start()}advance(t){super.advance(t),this.currentAnimation?.update(t)}draw(){this.image&&this.context.drawImage(this.image,0,0,this.image.width,this.image.height),this.currentAnimation&&this.currentAnimation.render({x:0,y:0,width:this.width,height:this.height,context:this.context}),this.color&&(this.context.fillStyle=this.color,this.context.fillRect(0,0,this.width,this.height))}};function k(){return new ct(...arguments)}var J=new WeakMap,bt={},pt={},Ot={0:"left",1:"middle",2:"right"};function ee(e,t){let{x:i,y:s,width:n,height:h}=W(e);do i-=e.sx||0,s-=e.sy||0;while(e=e.parent);let a=t.x-Math.max(i,Math.min(t.x,i+n)),d=t.y-Math.max(s,Math.min(t.y,s+h));return a*a+d*d<t.radius*t.radius}function ie(e){let t=e._lf.length?e._lf:e._cf;for(let i=t.length-1;i>=0;i--){let s=t[i];if(s.collidesWithPointer?s.collidesWithPointer(e):ee(s,e))return s}}function b(e,t){return parseFloat(e.getPropertyValue(t))||0}function se(e){let{canvas:t,_s:i}=e,s=t.getBoundingClientRect(),n=i.transform!="none"?i.transform.replace("matrix(","").split(","):[1,1,1,1],h=parseFloat(n[0]),a=parseFloat(n[3]),d=(b(i,"border-left-width")+b(i,"border-right-width"))*h,f=(b(i,"border-top-width")+b(i,"border-bottom-width"))*a,c=(b(i,"padding-left")+b(i,"padding-right"))*h,o=(b(i,"padding-top")+b(i,"padding-bottom"))*a;return{scaleX:(s.width-d-c)/t.width,scaleY:(s.height-f-o)/t.height,offsetX:s.left+(b(i,"border-left-width")+b(i,"padding-left"))*h,offsetY:s.top+(b(i,"border-top-width")+b(i,"padding-top"))*a}}function Et(e){let t=e.button!=null?Ot[e.button]:"left";pt[t]=!0,gt(e,"onDown")}function ot(e){let t=e.button!=null?Ot[e.button]:"left";pt[t]=!1,gt(e,"onUp")}function At(e){gt(e,"onOver")}function ne(e){let t=J.get(e.target);t._oo=null,pt={}}function Pt(e,t,i){let s=ie(e);s&&s[t]&&s[t](i),bt[t]&&bt[t](i,s),t=="onOver"&&(s!=e._oo&&e._oo&&e._oo.onOut&&e._oo.onOut(i),e._oo=s)}function gt(e,t){e.preventDefault();let i=e.target,s=J.get(i),{scaleX:n,scaleY:h,offsetX:a,offsetY:d}=se(s);e.type.includes("touch")?(Array.from(e.touches).map(({clientX:c,clientY:o,identifier:g})=>{let l=s.touches[g];l||(l=s.touches[g]={start:{x:(c-a)/n,y:(o-d)/h}},s.touches.length++),l.changed=!1}),Array.from(e.changedTouches).map(({clientX:c,clientY:o,identifier:g})=>{let l=s.touches[g];l.changed=!0,l.x=s.x=(c-a)/n,l.y=s.y=(o-d)/h,Pt(s,t,e),j("touchChanged",e,s.touches),t=="onUp"&&(delete s.touches[g],s.touches.length--,s.touches.length||j("touchEnd"))})):(s.x=(e.clientX-a)/n,s.y=(e.clientY-d)/h,Pt(s,t,e))}function Lt({radius:e=5,canvas:t=Mt()}={}){let i=J.get(t);if(!i){let s=window.getComputedStyle(t);i={x:0,y:0,radius:e,touches:{length:0},canvas:t,_cf:[],_lf:[],_o:[],_oo:null,_s:s},J.set(t,i)}return t.addEventListener("mousedown",Et),t.addEventListener("touchstart",Et),t.addEventListener("mouseup",ot),t.addEventListener("touchend",ot),t.addEventListener("touchcancel",ot),t.addEventListener("blur",ne),t.addEventListener("mousemove",At),t.addEventListener("touchmove",At),i._t||(i._t=!0,et("tick",()=>{i._lf.length=0,i._cf.map(s=>{i._lf.push(s)}),i._cf.length=0})),i}function Dt(...e){e.flat().map(t=>{let i=t.context?t.context.canvas:Mt(),s=J.get(i);if(!s)throw new ReferenceError("Pointer events not initialized for the objects canvas");t._r||(t._r=t.render,t.render=function(){s._cf.push(this),this._r()},s._o.push(t))})}function re(e){let t=e.canvas;e.clearRect(0,0,t.width,t.height)}function It({fps:e=60,clearCanvas:t=!0,update:i=q,render:s,context:n=$(),blur:h=!1}={}){if(!s)throw Error("You must provide a render() function");let a=0,d=1e3/e,f=1/e,c=t?re:q,o,g,l,_,C,O=!0;h||(window.addEventListener("focus",()=>{O=!0}),window.addEventListener("blur",()=>{O=!1})),et("init",()=>{C.context??=$()});function p(){if(g=requestAnimationFrame(p),!!O&&(l=performance.now(),_=l-o,o=l,!(_>1e3))){for(j("tick"),a+=_;a>=d;)C.update(f),a-=d;c(C.context),C.render()}}return C={update:i,render:s,isStopped:!0,context:n,start(){o=performance.now(),this.isStopped=!1,requestAnimationFrame(p)},stop(){this.isStopped=!0,cancelAnimationFrame(g)},_frame:p,set _last(N){o=N}},C}var he={},ae={},it={},K={Enter:"enter",Escape:"esc",Space:"space",ArrowLeft:"arrowleft",ArrowUp:"arrowup",ArrowRight:"arrowright",ArrowDown:"arrowdown"};function Yt(e=q,t){e._pd&&t.preventDefault(),e(t)}function oe(e){let t=K[e.code],i=he[t];it[t]=!0,Yt(i,e)}function le(e){let t=K[e.code],i=ae[t];it[t]=!1,Yt(i,e)}function de(){it={}}function zt(){let e;for(e=0;e<26;e++)K["Key"+String.fromCharCode(e+65)]=String.fromCharCode(e+97);for(e=0;e<10;e++)K["Digit"+e]=K["Numpad"+e]=""+e;window.addEventListener("keydown",oe),window.addEventListener("keyup",le),window.addEventListener("blur",de)}function E(e){return!![].concat(e).some(t=>it[t])}function ut(e){let t=[];return e._dn?t.push(e._dn):e.children&&e.children.map(i=>{t=t.concat(ut(i))}),t}var ft=class{constructor({id:t,name:i=t,objects:s=[],context:n=$(),cullObjects:h=!0,cullFunction:a=te,sortFunction:d,...f}){this._o=[],Object.assign(this,{id:t,name:i,context:n,cullObjects:h,cullFunction:a,sortFunction:d,...f});let c=this._dn=document.createElement("section");c.tabIndex=-1,c.style=Jt,c.id=t,c.setAttribute("aria-label",i);let o=this;class g extends tt{set x(_){o.sx=_-this.centerX,super.x=_}get x(){return super.x}set y(_){o.sy=_-this.centerY,super.y=_}get y(){return super.y}}this.camera=new g({context:n,anchor:{x:.5,y:.5},render:this._rf.bind(this)}),this.add(s),this._i=()=>{this.context??=$();let l=this.context.canvas,{width:_,height:C}=l,O=_/2,p=C/2;Object.assign(this.camera,{centerX:O,centerY:p,x:O,y:p,width:_,height:C}),this._dn.isConnected||vt(this._dn,l)},this.context&&this._i(),et("init",this._i)}set objects(t){this.remove(this._o),this.add(t)}get objects(){return this._o}add(...t){t.flat().map(i=>{this._o.push(i),i.parent=this,ut(i).map(s=>{this._dn.appendChild(s)})})}remove(...t){t.flat().map(i=>{kt(this._o,i),i.parent=null,ut(i).map(s=>{vt(s,this.context)})})}show(){this.hidden=this._dn.hidden=!1;let t=this._o.find(i=>i.focus);t?t.focus():this._dn.focus(),this.onShow()}hide(){this.hidden=this._dn.hidden=!0,this.onHide()}destroy(){Zt("init",this._i),this._dn.remove(),this._o.map(t=>t.destroy&&t.destroy())}lookAt(t){let{x:i,y:s}=t.world||t;this.camera.x=i,this.camera.y=s}update(t){this.hidden||this._o.map(i=>i.update&&i.update(t))}_rf(){let{_o:t,context:i,_sx:s,_sy:n,camera:h,sortFunction:a,cullObjects:d,cullFunction:f}=this;i.translate(s,n);let c=t;d&&(c=c.filter(o=>f(h,o))),a&&c.sort(a),c.map(o=>o.render&&o.render())}render(){if(!this.hidden){let{context:t,camera:i}=this,{x:s,y:n,centerX:h,centerY:a}=i;t.save(),this._sx=h-s,this._sy=a-n,t.translate(this._sx,this._sy),i.render(),t.restore()}}onShow(){}onHide(){}};function Gt(){return new ft(...arguments)}var{canvas:Rt,context:r}=Tt(),m=Rt.width,S=Rt.height;r.font="bold 20px monospace";r.textAlign="center";r.textBaseline="middle";var ht=1e3/60,ce=Math.PI*2,ue=new Path2D("M0 10 V0 h10, m10 0 h10 v10, m0 10 v10 h-10, m-10 0 h-10 v-10"),fe=new Path2D("M 1,3 A 2,2 0,0,1 5,3 A 2,2 0,0,1 9,3 Q 9,6 5,8 Q 1,6 1,3 Z"),T=!0,st=0,v=0,I=[[`You are the last alive,
defeat the remaining enemies.
Finish Level 5 and win.`,3,3,0],["Go ahead.",5,2,0],["Archers have appeared!",5,2,.3],["More to come!",15,2,.4],["The last battle to victory.",20,1,.5],["Thanks for playing.",0,0,0]],M=[],D=[],Wt=I[v][0],B=I[v][1],Bt=I[v][2],Ft=I[v][3],Ut=3,Y=3,F=Lt();zt();var u=k({x:m/2-7.5,y:S/2-7.5,radius:20,halfRadius:20/2,anchor:P(.5,.5),color:"#E8E3C8",update(){this.advance(ht);let e=P(0,0);E("w")||E("arrowup")?e.y=-1:(E("s")||E("arrowdown"))&&(e.y=1),E("a")||E("arrowleft")?e.x=-1:(E("d")||E("arrowright"))&&(e.x=1),e.x!==0&&e.y!==0&&(e=e.normalize()),e=e.scale(.15),this.dx=e.x,this.dy=e.y,this.x<this.radius?this.x=this.radius:this.x>m-this.radius&&(this.x=m-this.radius),this.y<this.radius?this.y=this.radius:this.y>S-this.radius&&(this.y=S-this.radius)},render(){r.fillStyle=this.color,r.beginPath(),r.arc(0,0,this.radius,0,Math.PI*2),r.fill()}}),U=k({x:u.x,y:u.y-u.height/2,width:10,height:40,anchor:P(.5,.8),isSwinging:!1,lastAttackTime:0,attackDur:.4,time:0,margin:u.radius*1.8,lastAngle:0,amplitude:1.5,period:400,phase:1.5,attack(){this.isSwinging!==!0&&(this.lastAngle=this.rotation-1.6,this.lastAttackTime=Date.now(),this.isSwinging=!0)},update(){let e=Math.atan2(F.y-u.y,F.x-u.x);if(this.rotation=e+1.6,!this.isSwinging){this.x=u.x+Math.cos(e)*this.margin,this.y=u.y+Math.sin(e)*this.margin;return}this.time+=ht,this.x=u.x+Math.cos(e)*this.margin,this.y=u.y+Math.sin(e)*this.margin,this.rotation+=Math.cos(ce/this.period*this.time+this.phase)*this.amplitude,this.time/1e3>=this.attackDur&&(this.isSwinging=!1,this.time=0)},render(){r.fillStyle="#E8E3C8",r.beginPath();let e=this.width*.5;r.lineTo(0,2),r.lineTo(e,-e),r.lineTo(this.width,2),r.roundRect(0,0,this.width,this.height,2),r.roundRect(-e,this.height-12,this.width*2,5,5),r.fill()}}),Nt=k({x:F.x,y:F.y,width:30,height:30,size:5,anchor:P(.5,.5),color:"#E8E3C8",update(){this.x=R(20,m-(this.width-10),F.x),this.y=R(20,S-(this.height-10),F.y)},render(){r.lineWidth=this.size,r.strokeStyle=this.color,r.stroke(ue)},onDown(){U.attack()}}),pe=k({x:0,y:0,width:m,height:S,render(){for(let n=0;n<Ut;n++){let h=35*n;k({x:30+h,y:30,width:30,height:30,scaleX:3,scaleY:3,color:"#E8E3C8",render(){r.fillStyle=this.color,r.strokeStyle=this.color,r[n<Y?"fill":"stroke"](fe)}}).render()}let e=`Live Enemy: ${B}`,t=r.measureText(e).width;r.shadowOffsetX=3,r.shadowOffsetY=2,r.fillStyle="rgb(232, 227, 200)",r.fillText(e,m-30-t/2,50),r.font="bold 30px monospace",r.fillText(`Level: ${v+1}`,m/2,50);let i=0,s=T||Y<=0;if(s&&(r.fillStyle="rgba(132, 127, 100, 0.3)",r.fillRect(-3,-2,this.width,this.height),r.font="bold 30px monospace",r.fillStyle="rgb(232 227 200)"),Y<=0)r.fillText("You lost, try again!",m*.5,S*.3);else if(T){let n=Wt.split(`
`);for(let h of n)i+=r.measureText(h).fontBoundingBoxAscent+20,r.fillText(h,m*.5,S*.3+i)}s&&v<5&&(r.font="bold 16px monospace",r.fillText("(Press space to start)",m*.5,S*.4+i))}});function ge(){let e=nt(),t=0,i=0;return e?(t=mt(-20,m+20),i=nt()?-20:S+20):(t=nt()?-20:m+20,i=mt(-20,S+20)),{x:t,y:i}}function we(e,t){return k({x:e,y:t,speed:3,width:40,height:40,color:"#FF7D6E",anchor:P(.5,.5),time:0,arrowDelay:2,throwArrow(){if(this.time<=this.arrowDelay)return;this.time=0;let s=this.position.subtract(u.position).normalize().scale(this.speed),n=Math.atan2(this.y-u.y,this.x-u.x),h=k({color:"#FF7D6E",x:this.x,y:this.y,width:20,height:5,rotation:n,isOffScreen(){return this.x<0||this.x>m||this.y<0||this.y>S},update(){this.x-=s.x,this.y-=s.y}});D.push(h)},update(){let s=this.position.subtract(u.position);if(s.length()<=this.width*6){this.time+=ht/1e3,this.throwArrow();return}this.rotation+=.05;let n=s.normalize().scale(this.speed);this.x-=n.x,this.y-=n.y},render(){r.fillStyle=this.color,r.beginPath(),r.roundRect(0,0,this.width,this.height,10),r.fill()}})}function me(e,t,i){return k({x:e,y:t,speed:i,width:40,height:40,color:"#FF7D6E",anchor:P(.5,.5),update(){this.rotation+=.05;let n=this.position.subtract(u.position).normalize().scale(this.speed);this.x-=n.x,this.y-=n.y},render(){r.fillStyle=this.color,r.beginPath(),r.roundRect(0,0,this.width,this.height,10),r.fill()}})}function _e(){let{x:e,y:t}=ge(),i=mt(1,3);return nt(Ft)?we(e,t):me(e,t,i)}function Xt(e,t){let i=W(t),s=Math.cos(t.rotation),n=Math.sin(t.rotation),h=e.x,a=e.y;e.x<i.x?h=i.x:e.x>i.x+i.width&&(h=i.x+i.width),e.y<i.y?a=i.y:e.y>i.y+i.height&&(a=i.y+i.height);let d=e.x-h,f=e.y-a;return Math.hypot(d,f)<e.radius}function ye(e,t){let i=W(e),s=W(t);return i.x+i.width>=s.x&&i.x<=s.x+s.width&&i.y+i.height>=s.y&&i.y<s.y+s.height}function xe(){v++,Wt=I[v][0]}function Ht(){B=I[v][1],Bt=I[v][2],Ft=I[v][3],M.length=0,U.isSwinging=!1,U.time=0,u.x=m/2-u.radius/2,u.y=S/2-u.radius/2,st=0,Y<=0&&(Y=Ut),T=!1}Dt(Nt);var Se=Gt({objects:[u,U,pe,Nt]}),$t=Se,ve=It({clearScreen:!1,update(){if(T&&v<5&&E("space")&&Ht(),!T&&st>=Bt&&M.length<B){let e=_e();M.push(e),st=0}st+=ht/1e3;for(let e=0;e<M.length;e++){let t=M[e],i=Xt(u,t),s=U.isSwinging&&ye(U,t);if(i){Y-=1,M.splice(e,1),B-=1,wt("damage");continue}else if(s){M.splice(e,1),B-=1,wt("hit");continue}t.update()}for(let e=0;e<D.length;e++){let t=D[e];if(Xt(u,t)){D.splice(e,1),Y-=1,wt("damage");continue}if(t.isOffScreen()){D.splice(e,1);continue}t.update()}$t.update(),Y<=0&&(M.length=0,D.length=0,T=!0),!T&&B<=0&&(T=!0,D.length=0,xe())},render(){r.fillStyle="#FCA6AC",r.fillRect(0,0,m,S),r.shadowColor="#2176CC",r.shadowOffsetX=4,r.shadowOffsetY=4,T&&v<5&&E("space")&&Ht();for(let e of M)e.render();for(let e of D)e.render();$t.render()}});ve.start();var mt=(e,t)=>Math.floor(Math.random()*(t-e+1))+e,nt=(e=.5)=>Math.random()>1-e;function wt(e,t=.3){yt=t,_t(...Ce[e])}var Ce={hit:[1.66,,163,.01,.04,.03,,.1,-8.8,.1,,,,,,.1,.03,.59,.05],damage:[1.6,,278,,.01,.01,2,.7,-7.1,,,,.07,1,,,.09,.81,.08],upgrade:[1.81,,27,.04,.17,.47,2,1.26,-3.1,,,.08,,,,,.14,.54,.2,.29]},_t,yt,rt;yt=.3;_t=(e=1,t=.05,i=220,s=0,n=0,h=.1,a=0,d=1,f=0,c=0,o=0,g=0,l=0,_=0,C=0,O=0,p=0,N=1,V=0,xt=0,x=Math,y=44100,A=2*x.PI,Vt=f*=500*A/y/y,St=i*=(1-t+2*t*x.random(t=[]))*A/y,z=0,Qt=0,w=0,Q=1,Kt=0,qt=0,L=0,at,G)=>{for(s=y*s+9,V*=y,n*=y,h*=y,p*=y,c*=500*A/y**3,C*=A/y,o*=A/y,g*=y,l=y*l|0,G=s+V+n+h+p|0;w<G;t[w++]=L)++qt%(100*O|0)||(L=a?1<a?2<a?3<a?x.sin((z%A)**3):x.max(x.min(x.tan(z),1),-1):1-(2*z/A%2+2)%2:1-4*x.abs(x.round(z/A)-z/A):x.sin(z),L=(l?1-xt+xt*x.sin(A*w/l):1)*(0<L?1:-1)*x.abs(L)**d*yt*e*(w<s?w/s:w<s+V?1-(w-s)/V*(1-N):w<s+V+n?N:w<G-p?(G-w-p)/h*N:0),L=p?L/2+(p>w?0:(w<G-p?1:(G-w)/p)*t[w-p|0]/2):L),at=(i+=f+=c)*x.cos(C*Qt++),z+=at-at*_*(1-1e9*(x.sin(w)+1)%2),Q&&++Q>g&&(i+=o,St+=o,Q=0),!l||++Kt%l||(i=St,f=Vt,Q=Q||1);return e=rt.createBuffer(1,G,y),e.getChannelData(0).set(t),i=rt.createBufferSource(),i.buffer=e,i.connect(rt.destination),i.start(),i};rt=new AudioContext;window.zzfx=_t;})();
/**
 * @preserve
 * Kontra.js v9.0.0
 */